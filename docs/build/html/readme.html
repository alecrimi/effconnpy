<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>effconnpy &#8212; effconnpy 0.1.24 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=ebdbb45b"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="effconnpy">
<h1>effconnpy<a class="headerlink" href="#effconnpy" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p><img alt="Build Status" src="https://img.shields.io/badge/build-passing-brightgreen" /> <a class="reference external" href="https://mybinder.org/v2/gh/alecrimi/effconnpy/main"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<figure class="align-default" id="id1">
<img alt="Help Wanted" src="https://img.shields.io/badge/help%20wanted-issues-orange?style=for-the-badge" />
<figcaption>
<p><span class="caption-text">Help Wanted</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Effconnpy</span></code> is a Python library for advanced causal inference and
connectivity analysis in time series data, offering both bivariate and
multivariate approaches. The toolbox assumes that neuroimging data
(e.g. from Nifti files) have been already pre-processed e.g. with
fMRI-prep, and parcellated, therefore the time series have been saved in
text files as .tsv and can easily be loaded into a dataframe.</p>
</section>
<section id="bivariate-causality-analysis">
<h2>Bivariate Causality Analysis<a class="headerlink" href="#bivariate-causality-analysis" title="Link to this heading">¶</a></h2>
<p>Two core classes provide bivariate causal inference methods:</p>
<section id="causalityanalyzer">
<h3>1. CausalityAnalyzer<a class="headerlink" href="#causalityanalyzer" title="Link to this heading">¶</a></h3>
<p>Basic methods include: - Bivariate Granger Causality - Bivariate
Transfer Entropy - Bivariate Convergent Cross Mapping</p>
</section>
<section id="extendedcausalityanalyzer">
<h3>2. ExtendedCausalityAnalyzer<a class="headerlink" href="#extendedcausalityanalyzer" title="Link to this heading">¶</a></h3>
<p>Extended methods include: - Dynamic Bayesian Network - Structural
Equation Modeling - DoWhy Causal Discovery - Dynamic Causal Modeling</p>
</section>
</section>
<section id="multivariate-causality-analysis">
<h2>Multivariate Causality Analysis<a class="headerlink" href="#multivariate-causality-analysis" title="Link to this heading">¶</a></h2>
<p>Three specialized multivariate approaches:</p>
<section id="multivariate-granger-causality">
<h3>1. Multivariate Granger Causality<a class="headerlink" href="#multivariate-granger-causality" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Based on methodology by Barnett &amp; Seth, Journal of Neuroscience
Methods 2014</p></li>
<li><p>VAR model-based causality inference</p></li>
<li><p>Log-likelihood ratio testing</p></li>
</ul>
</section>
<section id="multivariate-convergent-cross-mapping-ccm">
<h3>2. Multivariate Convergent Cross-Mapping (CCM)<a class="headerlink" href="#multivariate-convergent-cross-mapping-ccm" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Inspired by Nithya &amp; Tangirala, ICC 2019</p></li>
<li><p>Nonlinear causality detection</p></li>
<li><p>Network-based causal relationship visualization</p></li>
</ul>
</section>
<section id="multivariate-transfer-entropy">
<h3>3. Multivariate Transfer Entropy<a class="headerlink" href="#multivariate-transfer-entropy" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Methodology from Duan et al. 2022</p></li>
<li><p>Information-theoretic causality measure</p></li>
<li><p>Supports conditional transfer entropy</p></li>
</ul>
<p>N.B. The multivariate implementations are not considered
state-of-the-art and are not fully tested, please report any error or
bug.</p>
</section>
</section>
<section id="visualization-of-effective-connectivity">
<h2>Visualization of effective connectivity<a class="headerlink" href="#visualization-of-effective-connectivity" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Plotting of directed graphs, also overlapping with tractography and
node labels</p></li>
<li><p>Directionality of the connections as color gradients</p></li>
<li><p>Visualization of time series over structural connections (currently
not working properly)</p></li>
</ul>
<p align="center"></p></section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>effconnpy
</pre></div>
</div>
</section>
<section id="quick-example">
<h2>Quick Example<a class="headerlink" href="#quick-example" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">effconnpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">CausalityAnalyzer</span>  <span class="p">,</span> <span class="n">create_connectivity_matrix</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="c1"># Generate sample time series</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">CausalityAnalyzer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">causality_test</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;granger&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="n">binary_matrix</span> <span class="o">=</span>  <span class="n">create_connectivity_matrix</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;granger&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">binary_matrix</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="multivariate-gc-example-using-causal-logistic-maps">
<h2>Multivariate GC Example using causal logistic maps<a class="headerlink" href="#multivariate-gc-example-using-causal-logistic-maps" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">effconnpy.multivariateGC</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultivariateGrangerCausality</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">effconnpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_connectivity_matrix</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Generate sample time series</span>
<span class="c1">#The first 2 time series are related by a logistic causal mapping,</span>
<span class="c1">#while the third is random and has no causal relationship with the others</span>
<span class="c1"># Parameters</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Number of time steps</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="c1"># Initial conditions</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="c1"># Iterate the system</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">3.8</span> <span class="o">-</span> <span class="mf">3.8</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
    <span class="n">y</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">3.1</span> <span class="o">-</span> <span class="mf">3.1</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">MultivariateGrangerCausality</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">multivariate_granger_causality</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
<p>Indeed, there is also a causal time series generator script to generate
ground-truth time series which can be complemented by random or other
time series:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">effconnpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">timeseriesgenerator</span>
<span class="c1"># Create an instance of the generator</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">TimeSeriesGenerator</span><span class="p">()</span>
<span class="c1"># Generate some example data</span>
<span class="n">n_points</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Lorenz system</span>
<span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">lorenz_system</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span>

<span class="c1"># Coupled logistic map</span>
<span class="n">logistic_x</span><span class="p">,</span> <span class="n">logistic_y</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">coupled_logistic_map</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span>

<span class="c1"># Kuramoto oscillators</span>
<span class="n">kura1</span><span class="p">,</span> <span class="n">kura2</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">kuramoto_oscillators</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span>

<span class="c1"># AR process</span>
<span class="n">ar_x</span><span class="p">,</span> <span class="n">ar_y</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">ar_process</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span>

<span class="c1"># Nonlinear coupled system</span>
<span class="n">nl_x</span><span class="p">,</span> <span class="n">nl_y</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">nonlinear_coupled_system</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="visualization-of-effective-connectivity-example">
<h2>Visualization of effective connectivity example<a class="headerlink" href="#visualization-of-effective-connectivity-example" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">effconnpy</span><span class="w"> </span><span class="kn">import</span>  <span class="n">vis_effconn</span>

<span class="n">node_file</span> <span class="o">=</span> <span class="s2">&quot;Node_AAL90.node&quot;</span>
<span class="n">edge_file</span> <span class="o">=</span> <span class="s2">&quot;my_effconn.csv&quot;</span>

<span class="n">vis_effconn</span><span class="p">(</span><span class="n">node_file</span><span class="p">,</span> <span class="n">edge_file</span><span class="p">,</span> <span class="n">show_tractography</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This will show the overlay of a tractography from the HCP dataset over a
connectome according to an atlas with given nodes coordinates, and the
effective connectivity computed and saved in a csv file. If a structural
connectivity matrix (non-effective) is passed, the function whill show
arrows on both directions for all edges.</p>
</section>
<section id="citation">
<h2>Citation<a class="headerlink" href="#citation" title="Link to this heading">¶</a></h2>
<p>If you use the tool please refer to those papers</p>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1053811921005644">“Structurally constrained Granger causality” A. Crimi et al. Neuroimage
2021</a></p>
<p><a class="reference external" href="https://ieeexplore.ieee.org/document/10839398">“End-to-End Stroke Imaging Analysis Using Effective Connectivity and
Interpretable Artificial Intelligence” Wojciech Ciezobka; Joan
Falcó-Roget; Cemal Koba; Alessandro Crimi, IEEE Access
2025</a></p>
</section>
<section id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Link to this heading">¶</a></h2>
<p>Contributions welcome! Please read our contributing guidelines before
submitting pull requests. Currently disabled, just open issues and I
will follow up</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p>MIT License</p>
<p><a class="reference external" href="https://star-history.com/#alecrimi/effconnpy"><img alt="Star History Chart" src="https://api.star-history.com/svg?repos=alecrimi/effconnpy&amp;type=Date" /></a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">effconnpy</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Alessandro Crimi.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/readme.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>